var __defProp=Object.defineProperty;var __defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value;var __publicField=(obj,key,value)=>__defNormalProp(obj,typeof key!="symbol"?key+"":key,value);var InlineRenderer=class{static render(text){return text.replace(/`([^`]+)`/g,"<code>$1</code>").replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>").replace(/\*([^*]+)\*/g,"<em>$1</em>").replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2">$1</a>')}};var BlockToken=class{constructor(content){__publicField(this,"content");this.content=content}static match(line){return!1}static fromLine(line){return null}merge(next){return!1}renderHTML(){return this.content=InlineRenderer.render(this.content),""}get rawContent(){return this.content}};var HeaderToken=class _HeaderToken extends BlockToken{constructor(content,depth){super(content);__publicField(this,"depth");this.depth=depth}static match(line){return/^(#{1,6})\s+/.test(line)}static fromLine(line){let out=line.match(/^(#{1,6})\s+(.*)$/);return out!=null?new _HeaderToken(out[2],out[1].length):new _HeaderToken("Error",1)}renderHTML(){return"<h".concat(this.depth,">").concat(this.content,"</h").concat(this.depth,">")}};var ParagraphToken=class extends BlockToken{constructor(content){super(content)}static fromLine(line){return new this(line)}static match(line){return!0}merge(next){if(!next.content.trim()&&!this.content.trim())return!0;if(next.content.trim()&&this.content.trim()){let newContent="".concat(this.content,"<br>").concat(next.content);return this.content=newContent,!0}return!1}renderHTML(){return super.renderHTML(),"<p>".concat(this.content.trim(),"</p>")}};var QuoteToken=class extends BlockToken{constructor(content){super(content)}static match(line){return/^(>)(.*)$/.test(line)}static fromLine(line){let match=line.match(/^(>)(.*)$/);if(!match)throw new Error("Quote not found in line '".concat(line,"'."));let content=match[2];return new this(content)}renderHTML(){return this.content=new MarkdownParser(this.content).parse(),this.content=this.content.replaceAll("\n","<br>"),super.renderHTML(),'<div class="article-quote">'.concat(this.content,"</div>")}merge(next){return this.content+="\n".concat(next.rawContent),!0}};var SeparatorToken=class _SeparatorToken extends BlockToken{constructor(){super("")}static match(line){return/^ *-{3,} *$/.test(line.trim())}static fromLine(line){return new _SeparatorToken}renderHTML(){return"<hr/>"}};var ListToken=class extends BlockToken{constructor(content,depth){super(content);__publicField(this,"depth");this.depth=depth}static match(line){return/^( *)-(?!-)\s*(.*)/.test(line)}static fromLine(line){let match=line.match(/^( *)-(?!-)\s*(.*)/);if(!match)throw new Error("List not found in line '".concat(line,"'."));let depth=match[1].length+1,content=match[2];return new this(content,depth)}merge(next){return next.depth==this.depth?(this.content+="\n".concat(next.rawContent),!0):!1}renderHTML(){super.renderHTML();let lines=this.content.split("\n"),htmlOutput="";for(let i=0;i<this.depth;i++)htmlOutput+="<ul>";lines.forEach(e=>{htmlOutput+="<li>".concat(e,"</li>")});for(let i=0;i<this.depth;i++)htmlOutput+="</ul>";return htmlOutput}};var MarkdownParser=class{constructor(markdown){__publicField(this,"types");__publicField(this,"markdown");this.types=[HeaderToken,QuoteToken,SeparatorToken,ListToken,ParagraphToken],this.markdown=this.escape(markdown)}parse(){let lines=this.markdown.split("\n"),tokens=[];for(let line of lines){let tokenType=this.types.find(t=>t.match(line));tokenType&&tokens.push(tokenType.fromLine(line))}for(let i=1;i<tokens.length;i++){let t1=tokens[i-1],t2=tokens[i];this.compareTypes(t1,t2)&&t1.merge(t2)&&(tokens.splice(i,1),i--)}let html="";for(let token of tokens)html+=token.renderHTML();return html}escape(text){return text.replaceAll("\\=","&equals;").replaceAll("\\*","&ast;").replaceAll("\\_","&lowbar;").replaceAll("\\>","&gt;").replaceAll("\\`","&#96;").replaceAll("\\.","&#46").replaceAll("\\-","&ndash;").replaceAll("\\#","&num;")}compareTypes(t1,t2){return t1.constructor===t2.constructor}};
